# 端到端自動運転の分類  
（End-to-End Autonomous Driving Classification）

2025年現在、自動運転技術の発展において、**エンドツーエンド**（End-to-End, E2E）アーキテクチャが主流トレンドとなっています。これは、センサー入力を直接的に車両制御命令に変換する統一モデルまたはシステムを目的としています。しかし、「エンドツーエンド」の実現経路については複数の理解と技術ルートがあり、主に以下の3つに分類されます：

---

## 1. モジュラー型エンドツーエンドアーキテクチャ  
**(Modular End-to-End)**

### 技術特徴:
このアーキテクチャは、従来のモジュール構造（例：認識・予測・計画）を維持しつつも、これらのモジュールを微分可能なニューラルネットワークサブモジュールとして構築し、システム全体で結合学習・最適化を行うのが特徴です。その核となる利点は、**性能と解釈性の両立**です。

- **情報損失のない伝達**: 従来の人為的なインターフェース定義ではなく、ニューラルネットワークによるネイティブなデータ表現（例：BEV占有グリッド）を使用することで、モジュール間での情報損失や誤差伝播を削減します。
- **グローバル最適化**: 最終的な走行タスク（例：目的地への安全到着）を目標として最適化され、個別のサブタスクのみに焦点を当てた最適化ではありません。
- **解釈性**: 全体がE2Eで学習されていても、中間結果（例：鳥瞰図における障害物の占有率）を出力できるため、デバッグや検証が容易です。

### 主要技術および代表システム:
- **主要技術**:
  - **BEV + Transformer**: 複数カメラ画像から鳥瞰図（Bird's Eye View）を生成し、Transformerの注意メカニズムにより道路トポロジーや交通参加者の長距離依存関係を捉えます。
  - **占有グリッドネットワーク (Occupancy Networks)**: 従来のバウンディングボックス検出に頼らず、3D空間内の各ボクセルが占められているか否かを判定することで、異形の障害物（例：脱落したタイヤ、ビニール袋など）をより正確に識別できます。

- **代表システム**:
  - **Huawei ADS 3.0**: 「Perception-Cognition Modeling（知覚認知モデリング）」という考え方を採用し、`GOD`（General Obstacle Detection）ネットワークで認識を行い、`PDP`（Prediction Decision Planning）ネットワークで事前決定計画を行います。都市部の複雑な交差点シーンでは通過成功率が98％にも達しています。
  - **Tesla FSD V12**: 純粋なビジョンベースソリューションであり、マルチビューカメラデータから`BEV`空間の占有グリッドマップを生成し、それを基盤としたパスプランニングとコントロールを行うことで、高精度地図への依存を大幅に低減しました。
  - **上海人工知能研究所 UniAD**: 学術界の代表的存在として、認識・予測・計画などの複数モジュールを統合フレームワーク内で集約し、クロスモジュール勾配伝搬を通じてグローバル最適化を実現しています。

> 🔍【イメージ案】: BEV空間での占有グリッド表示やTransformerによる視覚的理解過程を図示した図表を挿入することを推奨します。

---

## 2. ダブルシステム型エンドツーエンドアーキテクチャ  
**(Dual-System End-to-End / VLA)**

### 技術特徴:
これはE2Eと大規模言語モデル（LLM）の強みを融合させたハイブリッドアーキテクチャで、しばしば**VLA (Vision-Language-Action) アーキテクチャ**と呼ばれます。これには協調して動作する2つのシステムが含まれます：
- **高速システム (Fast System)**: センサーデータをリアルタイム処理し、初期の運転軌道または制御命令を生成するE2Eニューラルネットワーク。応答速度確保が重要。
- **低速システム (Slow System)**: 大規模視覚言語モデル（VLM）であり、現在のシーンに対して高次の意味理解と推論（例：交通標識の意味理解、歩行者の意図分析、工事現場の看板解釈）を行い、高速システムに意思決定支援および修正提案を提供します。

### 利点:
E2Eの効率的な実行能力と、LLMの優れた意味理解・論理推論能力を組み合わせることで、複雑かつ曖昧な状況下でも人間の常識に即した意思決定を行うことが可能です。

### 代表システム:
- **Li Ideal（理想汽車）**: 明確にダブルシステムE2Eスキームを提示しており、一方のニューラルネットワークがリアルタイム制御を担当し、もう一方の視覚言語モデルがシーン意味解析と意思決定補助を担っています。
- **Changan Auto（長安汽車）「Tianshu（天枢）」大規模モデル**: 「脳」と「小脳」構造を採用。「小脳」が具体的な計画と制御を、「脳」が大規模モデルに基づく低速システムとして複雑な推論を担当します。
- **XPeng XNGP**: VLAスキームを採用していると考えられており、路面状況を「意味情報」に変換し、視覚と意味情報を総合的に活用して意思決定を出力することで、システムの理解性と安全性を向上させています。

> 🧠【イメージ案】: Fast SystemとSlow Systemの相互作用を示すフローチャート、または脳と小脳の役割分担を図解したイラストを挿入することを推奨します。

---

## 3. 単一モデル型エンドツーエンドアーキテクチャ  
**(One Model End-to-End)**

### 技術特徴:
最も純粋で革新的なE2Eルートであり、**一つの統合されたマルチモーダル大規模モデルで全ての自動運転タスク**（認識・予測・計画・制御）を完了することを目指しています。このモデルは「運転分野における汎用基礎モデル」と見なされています。
- **統一モデリング**: 自動運転問題を言語生成タスクに類似させて扱い、モデルがセンサー入力から直接制御命令を生成するだけでなく、自然言語インタラクションを通じて指示を受け取ることも可能です。
- **潜在的可能性**: 理論的には、タスク間のシナジー効果を最大限引き出すことができ、真の自律学習と一般化が期待されます。

### 課題:
モデルサイズが非常に大きく、計算資源と大量の高品質データに対する要求が極めて高く、訓練難易度も高いです。また、意思決定プロセスが高度にブラックボックス化しており、安全性・制御可能性・リアルタイム性に関する課題が依然として残っています。現時点では成熟した実車搭載案はありません。

### 代表システム・プロジェクト:
- **DriveMM**: 新しい大規模マルチモーダルモデルであり、画像およびマルチビュー動画を処理し、認識・予測・計画などの全タスクを遂行できます。
- **Wayve の GAIA-1 および LINGO-2**: 単一のニューラルネットワークモデルを構築し、カメラ入力から車両制御出力へ直接マッピングする先駆的試みです。
- **DriveGPT4**: 運転タスクをテキスト問題にマッピングし、大型言語モデルを利用して軌跡または制御命令を直接生成する試みです。

> ⚙️【イメージ案】: 単一モデル型E2Eの構成要素とフローを視覚的に表現したダイアグラム、またはWayveのGAIA/LINGOモデルの構造図を挿入することを推奨します。

---

## まとめ比較表

| ルート | コアコンセプト | 強み | 課題 | 代表例 |
| :--- | :--- | :--- | :--- | :--- |
| **モジュラー型E2E** | モジュール構造を保ちつつ連携最適化 | 解釈性が高く、開発しやすい、性能向上が顕著 | 単一モデルよりまだ複雑 | Huawei ADS 3.0, Tesla FSD V12, UniAD |
| **ダブルシステム型E2E (VLA)** | 高速実行＋低速推論 | より賢く安全な意思決定、双方のメリットを融合 | 計算負荷が高く、二つのシステムの連携が難しい | Li Ideal, Changan Tianshu, XPeng XNGP |
| **単一モデル型E2E** | 一つのモデルですべてを処理 | アーキテクチャがシンプルで理論的上限が高い | 学習困難、計算リソース要求が非常に高い、ブラックボックス問題が深刻 | Wayve (GAIA-1, LINGO-2), DriveMM |

---

結論として、産業界は従来のモジュール型アーキテクチャからE2Eへと進化しています。**モジュラー型E2E**および**ダブルシステム型E2E**（VLA）は、性能・安全性・エンジニアリング実現性のバランスを考慮して、多くの自動車メーカー（Huawei、Tesla、Li、XPengなど）にとって選択肢となっています。一方、**単一モデル型E2E**は将来の技術的方向性として位置づけられ、現在は研究・開発段階にあります。

> 📊【イメージ案】: 上記比較表を視覚的に表現した図表、または3つのアーキテクチャの概観図を挿入することを推奨します。